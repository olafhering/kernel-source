# KABI rules for symbols and modules
#
# A matching line with PASS allows kabi changes for given modules or symbols,
# FAIL causes an error. The first matching line is considered, the default is
# FAIL if no match is found.
#
# A pattern that contains slashes is matched against the module name a given
# symbol is exported from. The special pattern "vmlinux" matches built-in
# symbols. All other patterns match against symbol names.

drivers/staging/*		PASS

klp_*_patch			PASS
klp_shadow_*			PASS

# KVM internal symbols (except ops)
kvm_x86_ops			FAIL
arch/x86/kvm/*			PASS
arch/powerpc/kvm/*		PASS
kvmppc_*			PASS
__xive_vm_h_*			PASS
realmode_pfn_to_page		PASS
iommu_tce_xchg_rm		PASS
mm_iommu_lookup_rm		PASS
mm_iommu_ua_to_hpa_rm		PASS
mm_iommu_ua_to_hpa_shift_rm	PASS
__kvm_*				PASS
kvm_vcpu_gfn_to_*		PASS
gfn_to_*			PASS
mark_page_dirty			PASS
kvm_clear_guest			PASS
kvm_clear_guest_page		PASS
kvm_get_dirty_log		PASS
kvm_get_dirty_log_protect	PASS
kvm_get_kvm			PASS
kvm_gfn_to_hva_cache_init	PASS
kvm_io_bus_get_dev		PASS
kvm_io_bus_write		PASS
kvm_irq_has_notifier		PASS
kvm_is_visible_gfn		PASS
kvm_put_kvm			PASS
kvm_read_guest			PASS
kvm_read_guest_atomic		PASS
kvm_read_guest_cached		PASS
kvm_read_guest_page		PASS
kvm_set_memory_region		PASS
kvm_vcpu_block			PASS
kvm_vcpu_init			PASS
kvm_vcpu_kick			PASS
kvm_vcpu_mark_page_dirty	PASS
kvm_vcpu_on_spin		PASS
kvm_vcpu_read_guest		PASS
kvm_vcpu_read_guest_atomic	PASS
kvm_vcpu_read_guest_page	PASS
kvm_vcpu_uninit			PASS
kvm_vcpu_wake_up		PASS
kvm_vcpu_write_guest		PASS
kvm_vcpu_write_guest_page	PASS
kvm_vcpu_yield_to		PASS
kvm_write_guest			PASS
kvm_write_guest_cached		PASS
kvm_write_guest_offset_cached	PASS
kvm_write_guest_page		PASS
vcpu_load			PASS
vcpu_put			PASS
# functions shared between xive and kvm
xive_cleanup_irq_data		PASS
xive_native_populate_irq_data	PASS
# finctions internal to ppc radix mm
radix__*			PASS

# removed upstream, not included in inlines/defines
x86_spec_ctrl_get_default	PASS
x86_spec_ctrl_restore_host	PASS
x86_spec_ctrl_set		PASS
x86_spec_ctrl_set_guest		PASS

# struct posix_clock change (CVE-2020-10690 bsc#1170056)
posix_clock_register		PASS

# only inter-module local symbols
drivers/gpu/drm/meson/*		PASS

# nobody cares bcache symbols
drivers/md/bcache/*		PASS

# qed inter-module local symbols
drivers/net/ethernet/qlogic/qed/*	PASS
drivers/net/ethernet/qlogic/qede/*	PASS
drivers/infiniband/hw/qede/*	PASS
drivers/scsi/qedf/*		PASS
drivers/scsi/qedi/*		PASS
include/linux/qed/*		PASS
drivers/scsi/hisi_sas/*		PASS

# qla2xxx only has local symbols
drivers/scsi/qla2xxx/*		PASS

# only inter-module local symbols
drivers/nvdimm/*		PASS

# only inter-module local symbols
drivers/s390/net/qeth*		PASS

# ceph-related modules
net/ceph/libceph		PASS
drivers/block/rbd		PASS
fs/ceph				PASS

# no out-of-tree users
drivers/crypto/ccp/*		PASS

# intermodule syms shared between cxgb4 and cxgb4vf
drivers/net/ethernet/chelsio/cxgb4/*   PASS
drivers/net/ethernet/chelsio/cxgb4vf/* PASS
drivers/net/ethernet/chelsio/libcxgb/* PASS

# IOMMU related modules and symbols
get_dev_data			PASS
# ath9k local symbols
drivers/net/wireless/ath/ath9k/* PASS
